define("alinw/validator/3.1.0/validator",["./core","$","./async","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events","./utils","./rule","./item"],function(a,b,c){var d=a("./core"),e=(a("arale/widget/1.1.1/widget"),a("$")),f=d.extend({events:{"mouseenter .{{attrs.inputClass}}":"mouseenter","mouseleave .{{attrs.inputClass}}":"mouseleave","mouseenter .{{attrs.textareaClass}}":"mouseenter","mouseleave .{{attrs.textareaClass}}":"mouseleave","focus .{{attrs.itemClass}} input,textarea,select":"focus","blur .{{attrs.itemClass}} input,textarea,select":"blur"},attrs:{explainClass:"kuma-form-explain",itemClass:"kuma-form-item",itemHoverClass:"kuma-form-item-hover",itemFocusClass:"kuma-form-item-focus",itemErrorClass:"kuma-form-item-error",inputClass:"kuma-input",textareaClass:"kuma-textarea",showMessage:function(a,b){this.getExplain(b).html('<span class="kuma-tiptext kuma-tiptext-error"><i class="kuma-tiptext-icon kuma-icon" title="出错">&#xe602;</i>&nbsp;'+a+"</span>"),this.getItem(b).addClass(this.get("itemErrorClass"))},hideMessage:function(a,b){this.getExplain(b).html(b.attr("data-explain")||" "),this.getItem(b).removeClass(this.get("itemErrorClass"))}},setup:function(){f.superclass.setup.call(this);var a=this;this.on("autoFocus",function(b){a.set("autoFocusEle",b)})},addItem:function(a){f.superclass.addItem.apply(this,[].slice.call(arguments));var b=this.query(a.element);return b&&this._saveExplainMessage(b),this},_saveExplainMessage:function(a){var b=a.element,c=b.attr("data-explain");void 0===c&&b.attr("data-explain",this.getExplain(b).html())},getExplain:function(a){var b=this.getItem(a),c=b.find("."+this.get("explainClass"));if(0==c.length)var c=e('<div class="'+this.get("explainClass")+'"></div>').appendTo(b);return c},getItem:function(a){a=e(a);var b=a.parents("."+this.get("itemClass"));return b},mouseenter:function(a){this.getItem(a.target).addClass(this.get("itemHoverClass"))},mouseleave:function(a){this.getItem(a.target).removeClass(this.get("itemHoverClass"))},focus:function(a){var b=a.target,c=this.get("autoFocusEle");if(c&&c.get(0)==b){var d=this;return e(b).keyup(function(){d.set("autoFocusEle",null),d.focus({target:b})}),void 0}this.getItem(b).removeClass(this.get("itemErrorClass")),this.getItem(b).addClass(this.get("itemFocusClass")),this.getExplain(b).html(e(b).attr("data-explain"))},blur:function(a){this.getItem(a.target).removeClass(this.get("itemFocusClass"))}});c.exports=f}),define("alinw/validator/3.1.0/core",["$","alinw/validator/3.1.0/async","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events","alinw/validator/3.1.0/utils","alinw/validator/3.1.0/rule","alinw/validator/3.1.0/item"],function(a,b,c){function d(a){var b=a.element.attr(o);return b||(b=a.cid,a.element.attr(o,b)),b}var e,f=a("$"),g=a("alinw/validator/3.1.0/async"),h=a("arale/widget/1.1.1/widget"),i=a("alinw/validator/3.1.0/utils"),j=a("alinw/validator/3.1.0/item"),k=[],l={value:function(){},setter:function(a){return"function"!=typeof a?i.helper(a):a}},m=void 0,n=h.extend({attrs:{triggerType:"blur",checkOnSubmit:!0,stopOnError:!1,autoSubmit:!0,checkNull:!0,onItemValidate:l,onItemValidated:l,onFormValidate:l,onFormValidated:l,displayHelper:function(a){var b,c,d=a.element.attr("id");return d&&(b=f("label[for="+d+"]").text(),b&&(b=b.replace(/^[\*\s\:\：]*/,"").replace(/[\*\s\:\：]*$/,""))),c=a.element.attr("name"),b||c},showMessage:l,hideMessage:l,autoFocus:!0,failSilently:!1,skipHidden:!1},setup:function(){var a=this;this.items=[],e="form"==this.element.get(0).tagName.toLowerCase(),e&&(m=this.element.attr("novalidate"),this.element.attr("novalidate","novalidate"),this.get("checkOnSubmit")&&this.element.submit(function(b){b.preventDefault(),a.execute(function(b){b||a.get("autoSubmit")&&a.element.get(0).submit()})})),this.on("formValidate",function(){var a=this;f.each(this.items,function(b,c){var d=a.query(c.element);d&&d.get("hideMessage").call(a,null,c.element)})}),this.on("itemValidated",function(a,b,c){var d=this.query(c);d&&(a?this.query(c).get("showMessage").call(this,b,c):this.query(c).get("hideMessage").call(this,b,c))}),this.get("autoFocus")&&this.on("formValidated",function(b,c){if(b){var d=null;f.each(c,function(a,b){var c=b[0],e=b[2];return c?(d=e,!1):void 0}),"radio"!=d.attr("type")&&"checkbox"!=d.attr("type")&&(a.trigger("autoFocus",d),d.focus())}}),k.push(this)},Statics:f.extend({helper:i.helper},a("alinw/validator/3.1.0/rule"),{autoRender:function(a){var b=new this(a);f("input, textarea, select",b.element).each(function(a,c){c=f(c);var d=c.attr("type");if("button"==d||"submit"==d||"reset"==d)return!0;var e={};if(e.element="radio"==d||"checkbox"==d?f("[type="+d+"][name="+c.attr("name")+"]",b.element):c,!b.query(e.element)){var g=i.parseDom(c);if(!g.rule)return!0;f.extend(e,g),b.addItem(e)}})},query:function(a){return h.query(a)},validate:function(a){var b=f(a.element),c=new n({element:b.parents()});c.addItem(a),c.query(b).execute(),c.destroy()}}),addItem:function(a){var b=this;if(f.isArray(a))return f.each(a,function(a,c){b.addItem(c)}),this;if(a=f.extend({triggerType:this.get("triggerType"),checkNull:this.get("checkNull"),displayHelper:this.get("displayHelper"),showMessage:this.get("showMessage"),hideMessage:this.get("hideMessage"),failSilently:this.get("failSilently"),skipHidden:this.get("skipHidden")},a),0==f(a.element).length){if(a.failSilently)return this;throw new Error("element does not exist")}var c=new j(a);this.items.push(c),c.set("_handler",function(){(c.get("checkNull")||c.element.val())&&c.execute()});var e=c.get("triggerType");return e&&this.element.on(e,"["+o+"="+d(c)+"]",c.get("_handler")),c.on("all",function(){this.trigger.apply(this,[].slice.call(arguments))},this),this},removeItem:function(a){var b,c=a instanceof j?a.element:f(a),e=(this.items,this);return f.each(this.items,function(a,f){return c.get(0)==f.element.get(0)?(b=a,f.get("hideMessage").call(e,null,f.element),e.element.off(f.get("triggerType"),"["+o+"="+d(f)+"]",f.get("_handler")),f.destroy(),!1):void 0}),void 0!==b&&this.items.splice(b,1),this},execute:function(a){var b=this;this.trigger("formValidate",this.element);var c=function(){var c=null;f.each(d,function(a,b){return c=Boolean(b[0]),!c}),b.trigger("formValidated",Boolean(c),d,b.element),a&&a(Boolean(c),d,b.element)},d=[];return this.get("stopOnError")?g.forEachSeries(this.items,function(a,b){a.execute(function(a){d.push([].slice.call(arguments,0)),b(a)})},c):g.forEach(this.items,function(a,b){a.execute(function(){d.push([].slice.call(arguments,0)),b(null)})},c),this},destroy:function(){e&&(void 0==m?this.element.removeAttr("novalidate"):this.element.attr("novalidate",m),this.element.unbind("submit"));var a=this;f.each(this.items,function(b,c){a.removeItem(c)});var b;f.each(k,function(a,c){return c==this?(b=a,!1):void 0}),k.splice(b,1),n.superclass.destroy.call(this)},query:function(a){var b=h.query(a),c=null;return f.each(this.items,function(a,d){return d===b?(c=b,!1):void 0}),c}}),o="data-validator-set";c.exports=n}),define("alinw/validator/3.1.0/async",[],function(a,b,c){var d={};c.exports=d;var e=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},f=function(a,b){if(a.map)return a.map(b);var c=[];return e(a,function(a,d,e){c.push(b(a,d,e))}),c},g=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};d.nextTick="undefined"!=typeof process&&process.nextTick?process.nextTick:function(a){setTimeout(a,0)},d.forEach=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0;e(a,function(e){b(e,function(b){b?(c(b),c=function(){}):(d+=1,d===a.length&&c(null))})})},d.forEachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d===a.length?c(null):e())})};e()};var h=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.forEach].concat(b))}},i=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.forEachSeries].concat(b))}},j=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};d.map=h(j),d.mapSeries=i(j),d.series=function(a,b){if(b=b||function(){},a.constructor===Array)d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.forEachSeries(g(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}}}),define("alinw/validator/3.1.0/utils",["$","alinw/validator/3.1.0/rule","alinw/validator/3.1.0/async","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events"],function(require,exports,module){function unique(){return"__anonymous__"+u_count++}function parseRule(a){var b=a.match(/([^{}:\s]*)(\{[^\{\}]*\})?/);return{name:b[1],param:parseJSON(b[2])}}function parseJSON(str){function getValue(str){return'"'==str.charAt(0)&&'"'==str.charAt(str.length-1)||"'"==str.charAt(0)&&"'"==str.charAt(str.length-1)?eval(str):str}if(!str)return null;var NOTICE='Invalid option object "'+str+'".';str=str.slice(1,-1);var result={},arr=str.split(",");return $.each(arr,function(a,b){if(arr[a]=$.trim(b),!arr[a])throw new Error(NOTICE);var c=arr[a].split(":"),d=$.trim(c[0]),e=$.trim(c[1]);if(!d||!e)throw new Error(NOTICE);result[getValue(d)]=$.trim(getValue(e))}),result}function parseRules(a){return a?a.match(/[a-zA-Z0-9\-\_]+(\{[^\{\}]*\})?/g):null}function parseDom(a){var a=$(a),b={},c=[],d=a.attr("required");d&&(c.push("required"),b.required=!0);var e=a.attr("type");if(e&&"submit"!=e&&"cancel"!=e&&"checkbox"!=e&&"radio"!=e&&"select"!=e&&"select-one"!=e&&"file"!=e&&"hidden"!=e&&"textarea"!=e){if(!Rule.getRule(e))throw new Error('Form field with type "'+e+'" not supported!');c.push(e)}var f=a.attr("min");f&&c.push('min{"min":"'+f+'"}');var g=a.attr("max");g&&c.push("max{max:"+g+"}");var h=a.attr("minlength");h&&c.push("minlength{min:"+h+"}");var i=a.attr("maxlength");i&&c.push("maxlength{max:"+i+"}");var j=a.attr("pattern");if(j){var k=new RegExp(j),l=unique();Rule.addRule(l,k),c.push(l)}var m=a.attr("data-rule");return m=m&&parseRules(m),m&&(c=c.concat(m)),b.rule=0==c.length?null:c.join(" "),b}function helper(a,b){return b?(helpers[a]=b,this):helpers[a]}var $=require("$"),Rule=require("alinw/validator/3.1.0/rule"),u_count=0,helpers={};module.exports={parseRule:parseRule,parseRules:parseRules,parseDom:parseDom,helper:helper}}),define("alinw/validator/3.1.0/rule",["$","alinw/validator/3.1.0/async","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events"],function(a,b,c){function d(a,b,c){return l.isPlainObject(a)?(l.each(a,function(a,b){l.isArray(b)?d(a,b[0],b[1]):d(a,b)}),this):(j[a]=b instanceof n?new n(a,b.operator):new n(a,b),f(a,c),this)}function e(a,b){var c,d=a.rule;return c=a.message?l.isPlainObject(a.message)?a.message[b?"success":"failure"]:b?"":a.message:k[d][b?"success":"failure"],c?i(a,c):c}function f(a,b){return l.isPlainObject(a)?(l.each(a,function(a,b){f(a,b)}),this):(k[a]=l.isPlainObject(b)?b:{failure:b},this)}function g(a){return j[a].operator}function h(a,b){if(b){var c=j[a];return new n(null,function(a,d){c.operator(l.extend(null,a,b),d)})}return j[a]}function i(a,b){var c=b,d=/\{\{[^\{\}]*\}\}/g,e=/\{\{(.*)\}\}/,f=b.match(d);return f&&l.each(f,function(b,d){var f=d.match(e)[1],g=a[l.trim(f)];c=c.replace(d,g)}),c}var j={},k={},l=a("$"),m=(a("alinw/validator/3.1.0/async"),a("arale/widget/1.1.1/widget")),n=m.extend({initialize:function(a,b){if(this.name=a,b instanceof RegExp)this.operator=function(a,c){var d=b.test(l(a.element).val());c(d?null:a.rule,e(a,d))};else{if("function"!=typeof b)throw new Error("The second argument must be a regexp or a function.");this.operator=function(a,c){var d=b(a,function(b,d){c(b?null:a.rule,d||e(a,b))});void 0!==d&&c(d?null:a.rule,e(a,d))}}},and:function(a,b){if(a instanceof n)var c=a;else var c=h(a,b);if(!c)throw new Error('No rule with name "'+a+'" found.');var d=this,f=function(a,b){d.operator(a,function(d){d?b(d,e(a,!d)):c.operator(a,b)})};return new n(null,f)},or:function(a,b){if(a instanceof n)var c=a;else var c=h(a,b);if(!c)throw new Error('No rule with name "'+a+'" found.');var d=this,f=function(a,b){d.operator(a,function(d){d?c.operator(a,b):b(null,e(a,!0))})};return new n(null,f)},not:function(a){var b=h(this.name,a),c=function(a,c){b.operator(a,function(b){b?c(null,e(a,!0)):c(!0,e(a,!1))})};return new n(null,c)}});d("required",function(a){var b=l(a.element),c=b.attr("type");switch(c){case"checkbox":case"radio":var d=!1;return b.each(function(a,b){return l(b).prop("checked")?(d=!0,!1):void 0}),d;default:return Boolean(b.val())}},"请输入{{display}}"),d("email",/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,"{{display}}的格式不正确"),d("text",/.*/),d("password",/.*/),d("radio",/.*/),d("checkbox",/.*/),d("url",/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,"{{display}}的格式不正确"),d("number",/^[+-]?[1-9][0-9]*(\.[0-9]+)?([eE][+-][1-9][0-9]*)?$|^[+-]?0?\.[0-9]+([eE][+-][1-9][0-9]*)?$/,"{{display}}的格式不正确"),d("date",function(a){var b=l(a.element),c=b.val(),d=[];if(!c)return!0;if(/^\d{4}\-[01]?\d\-[0-3]?\d$/.test(c))d=c.split("-");else if(/^\d{4}\/[01]?\d\/[0-3]?\d$/.test(c))d=c.split("/");else if(/^\d{4}\.[01]?\d\.[0-3]?\d$/.test(c))d=c.split(".");else{if(!/^\d{4}年[01]?\d月[0-3]?\d[日号]$/.test(c))return!1;d.push(c.slice(0,c.search("年"))),d.push(c.slice(c.search("年")+1,c.search("月"))),d.push(c.slice(c.search("月")+1,c.search("日")))}var e=Number(d[0]),f=Number(d[1]),g=Number(d[2]);if(1e3>e||f>12||1>f||1>g)return!1;if([1,3,5,7,8,10,12].indexOf(f)>-1){if(g>31)return!1}else if([4,6,9,11].indexOf(f)>-1){if(g>30)return!1}else if(2==f)if(0==e%4&&0!=e%100||0==e%100&&0==e%400){if(g>29)return!1}else if(g>28)return!1;return!0},"{{display}}的格式不正确"),d("min",function(a){var b=a.element,c=a.min;return Number(b.val())>=Number(c)},"{{display}}必须大于或者等于{{min}}"),d("max",function(a){var b=a.element,c=a.max;return Number(b.val())<=Number(c)},"{{display}}必须小于或者等于{{max}}"),d("minlength",function(a){var b=a.element,c=b.val().length;return c>=Number(a.min)},"{{display}}的长度必须大于或等于{{min}}"),d("maxlength",function(a){var b=a.element,c=b.val().length;return c<=Number(a.max)},"{{display}}的长度必须小于或等于{{max}}"),d("mobile",/^1\d{10}$/,"请输入正确的{{display}}"),d("confirmation",function(a){var b=a.element,c=l(a.target);return b.val()==c.val()},"两次输入的{{display}}不一致，请重新输入"),c.exports={addRule:d,setMessage:f,getRule:h,getOperator:g}}),define("alinw/validator/3.1.0/item",["$","alinw/validator/3.1.0/utils","alinw/validator/3.1.0/rule","alinw/validator/3.1.0/async","arale/widget/1.1.1/widget","arale/base/1.1.1/base","arale/class/1.1.0/class","arale/events/1.1.0/events"],function(a,b,c){function d(a){return a=String(a),a.charAt(0).toUpperCase()+a.slice(1)}function e(a,b,c,d,e){if(!b){var f=!1,i=a.attr("type");switch(i){case"checkbox":case"radio":var l=!1;a.each(function(a,b){return g(b).prop("checked")?(l=!0,!1):void 0}),f=l;break;default:f=Boolean(a.val())}if(!f)return e&&e(null,null),void 0}if(!g.isArray(c))throw new Error("No validation rule specified or not specified as an array.");var m=[];g.each(c,function(b,c){var e=h.parseRule(c),f=e.name,i=e.param,j=k.getOperator(f);if(!j)throw new Error('Validation rule with name "'+f+'" cannot be found.');var l=g.extend({},i,{element:a,display:i&&i.display||d,rule:f});m.push(function(a){j(l,a)})}),j.series(m,function(a,b){e&&e(a,b[b.length-1])})}function f(a){return a?(a=a[0]||a,!a.offsetHeight):!0}var g=a("$"),h=a("alinw/validator/3.1.0/utils"),i=a("arale/widget/1.1.1/widget"),j=a("alinw/validator/3.1.0/async"),k=a("alinw/validator/3.1.0/rule"),l={value:function(){},setter:function(a){return"function"!=typeof a?h.helper(a):a}},m=i.extend({attrs:{rule:"",display:null,displayHelper:null,triggerType:{setter:function(a){if(!a)return a;var b=g(this.get("element")),c=b.attr("type"),d=b.get(0).tagName.toLowerCase().indexOf("select")>-1||"radio"==c||"checkbox"==c;return d&&(a.indexOf("blur")>-1||a.indexOf("key")>-1)?"change":a}},required:{value:!1,getter:function(a){return g.isFunction(a)?a():a}},checkNull:!0,errormessage:null,onItemValidate:l,onItemValidated:l,showMessage:l,hideMessage:l},setup:function(){this.get("required")&&(!this.get("rule")||this.get("rule").indexOf("required")<0)&&this.set("rule","required "+this.get("rule")),this.get("display")||"function"!=typeof this.get("displayHelper")||this.set("display",this.get("displayHelper")(this))},execute:function(a){if(this.get("skipHidden")&&f(this.element))return a&&a(null,"",this.element),this;this.trigger("itemValidate",this.element);var b=h.parseRules(this.get("rule")),c=this;return b?(e(this.element,this.get("required"),b,this.get("display"),function(b,e){if(b)var f=c.get("errormessage")||c.get("errormessage"+d(b))||e;else var f=e;c.trigger("itemValidated",b,f,c.element),a&&a(b,f,c.element)}),this):(a&&a(null,"",this.element),this)}});c.exports=m});
